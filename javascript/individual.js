$(document).ready(function(){$(window).hashchange(function(){$("body").off("click");var person_id=1;if(location.hash.length>0){person_id=parseInt(location.hash.substring(1))}var person=new Person(person_id);person.ready(displayPersonInfo)});$(window).hashchange()});function displayPersonInfo(person){var footnote_counter=new FootnoteCounter;$("#name").empty().append(nameLink(person,{showGender:true}));$("#lifespan").empty().append(getLifespan(person));$("#general-note").empty().html(person.note);$("#notes").empty().append("<h2>Notes</h2>");if(person.note)$("#notes").append("<h3>General</h3>",person.note);$("#media").empty().append(buildMediaList(person.media));$("#sources").empty();if(person.sources.length>0){$("#sources").replaceWith(footnoteDiv(person.sources,"sources",{header:"Sources",addClass:"general"}));$("#sources").prepend("<h2>Endnotes</h2>")}else{$("#sources").prepend("<h2>Endnotes</h2>").addClass("empty-general")}$events=$("#events");$events.empty();var has_events=person.events.length>0;$event_table=buildEventTable(person.events,{counter:footnote_counter});$.each(person.families,function(index,family){has_events=true;$event_table.extendEvents(family.events,{family:family})});if(has_events){$event_table.appendTo($events)}else{$events.append("<span class='empty'>no events</span>")}var $families=$("#families").empty();$families.append(buildFamilyTables(person));var $webtags=$("#webtags").empty();if(person.webtags.length>0){$webtags.append("<h2>Webtags</h2>");$.each(person.webtags,function(index,webtag){var $tagdiv=$("<div class='webtag'/>");$("<a href='"+webtag.url+"' target='_blank'>"+(webtag.name||webtag.url)+"</a>").appendTo($tagdiv);if(webtag.note){$tagdiv.append(noteLink({type:webtag.name||"",note:webtag.note}))}$webtags.append($tagdiv)})}}